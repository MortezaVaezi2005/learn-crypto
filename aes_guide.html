<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุฑุงูููุง ุฌุงูุน AES ุจุง ุงุตูู ุฌุจุฑ ุฎุท ู ูุงุดู ุญุณุงุจ ุณุงุฏู</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;500;700&display=swap');

        body {
            font-family: 'Vazirmatn', 'Tahoma', 'Helvetica', sans-serif;
            line-height: 1.8;
            margin: 0;
            padding: 20px 0;
            background-color: #f8f9fa;
            color: #343a40;
            direction: rtl;
        }
        .container {
            width: 85%;
            max-width: 900px;
            margin: 30px auto;
            background-color: #ffffff;
            padding: 35px 45px;
            border-radius: 12px;
            box-shadow: 0 6px 12px rgba(0,0,0,0.1);
            border-top: 5px solid #28a745; /* Green accent for AES */
        }
        h1 {
            text-align: center;
            color: #1e7e34; /* Darker Green */
            margin-bottom: 35px;
            font-weight: 700;
        }
        h2 {
            color: #28a745; /* Primary Green */
            margin-top: 30px;
            margin-bottom: 20px;
            font-weight: 500;
            border-bottom: 2px solid #e9ecef;
            padding-bottom: 10px;
        }
        h3 {
            color: #218838; /* Darker shade of Green */
            margin-top: 25px;
            margin-bottom: 15px;
            font-weight: 500;
        }
         h4 {
            color: #155724; /* Even darker green for sub-operation titles */
            margin-top: 20px;
            margin-bottom: 10px;
            font-weight: bold; /* Make H4 bold for emphasis */
        }
        p, .math-explanation {
            margin-bottom: 15px;
            font-size: 1.05em;
        }
        ul, ol {
            padding-right: 20px;
            margin-bottom: 15px;
        }
        li {
            margin-bottom: 10px;
            font-size: 1.05em;
        }
        strong {
            font-weight: bold; /* Standard bold */
            color: #007bff; 
        }
        code, .code-block {
            font-family: 'Consolas', 'Menlo', 'Courier New', monospace;
            background-color: #e9ecef;
            padding: 3px 7px;
            border-radius: 4px;
            font-size: 0.9em;
            color: #c7254e; 
            direction: ltr; 
            display: inline-block;
        }
        .code-block { /* For multi-line code or matrix display */
            display: block;
            padding: 10px;
            margin: 10px 0;
            white-space: pre;
            overflow-x: auto;
            border: 1px solid #ddd;
            background-color: #f5f5f5;
        }
        .note {
            font-size: 0.95em;
            color: #5a5a5a; /* Slightly darker grey for notes */
            padding: 10px 15px;
            background-color: #f0f0f0; /* Lighter grey */
            border-right: 4px solid #28a745; /* Green accent */
            border-radius: 4px;
            margin-top: 20px;
        }
         .math-section { /* For detailed math explanations */
            padding: 15px;
            margin-top:20px;
            margin-bottom:20px;
            background-color: #e6fff2; /* Very light green */
            border: 1px solid #a3d8b8; /* Light green border */
            border-radius: 6px;
        }
        .math-section p, .math-section ul, .math-section ol { font-size: 1em; }


        /* Styles for Simple AES Calculator (Unchanged from previous) */
        #simple-aes-calculator {
            margin-top: 30px;
            padding: 20px;
            border: 1px solid #c3e6cb; 
            border-radius: 8px;
            background-color: #f0fff4; 
        }
        #simple-aes-calculator h3 {
            color: #155724; 
            text-align: center;
            margin-bottom: 20px;
        }
        .aes-calc-group {
            margin-bottom: 20px;
        }
        .aes-calc-group label { 
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #343a40;
        }
        .aes-calc-group input[type="text"], 
        .aes-calc-group textarea {
            width: calc(100% - 24px);
            padding: 10px;
            margin-bottom: 10px;
            border: 1px solid #b8dabf;
            border-radius: 4px;
            font-family: 'Vazirmatn', 'Tahoma', sans-serif; 
            font-size: 1em;
        }
        .aes-calc-group textarea {
            min-height: 80px;
            resize: vertical;
        }
        .aes-calc-group input[type="text"] { 
            direction: ltr;
            background-color: #e9f7ef;
        }
        #simple-aes-calculator button { 
            background-color: #28a745; 
            color: white;
            padding: 10px 18px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-family: 'Vazirmatn', 'Tahoma', sans-serif;
            font-size: 1em;
            transition: background-color 0.3s ease;
            margin: 5px 0;
        }
        #simple-aes-calculator button:hover {
            background-color: #218838; 
        }
        .key-display-area {
            padding: 10px;
            background-color: #e9f7ef;
            border: 1px solid #b8dabf;
            border-radius: 4px;
            margin-bottom: 15px;
            font-family: 'Consolas', 'Menlo', monospace;
            direction: ltr;
            word-break: break-all;
        }
        .key-display-area strong { color: #155724; }

        .calc-log-aes-simple {
            margin-top: 20px;
            background-color: #343a40; 
            color: #f8f9fa; 
            padding: 15px;
            border-radius: 5px;
            font-family: 'Consolas', 'Menlo', 'Courier New', monospace;
        }
        .calc-log-aes-simple h4 { 
            color: #28a745; 
            margin-top: 0;
            margin-bottom: 10px;
            font-family: 'Vazirmatn', 'Tahoma', sans-serif;
            text-align: right;
        }
        .calc-log-aes-simple pre { 
            white-space: pre-wrap; 
            word-wrap: break-word;
            font-size: 0.9em;
            max-height: 200px;
            overflow-y: auto;
            direction: ltr; 
            text-align: left;
        }

        @media (max-width: 768px) {
            .container { width: 95%; padding: 25px 20px; }
            h1 { font-size: 1.8em; }
            h2 { font-size: 1.5em; }
            p, li { font-size: 1em; }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ุฑุงูููุง ุฌุงูุน ุงูฺฏูุฑุชู ุฑูุฒูฺฏุงุฑ AES ุจุง ุงุตูู ุฌุจุฑ ุฎุท ๐ก๏ธ</h1>
        
        <section id="aes-introduction-detailed">
            <h2>ููุฏูู: AES ู ุณุงุฎุชุงุฑ ุฏุงุฏู</h2>
            <p>
                ุงูฺฏูุฑุชู <strong>AES (Advanced Encryption Standard)</strong> ฺฉ ุงุณุชุงูุฏุงุฑุฏ ุฑูุฒูฺฏุงุฑ ูพุดุฑูุชู ู ูุชูุงุฑู ุงุณุช ฺฉู ุฏุงุฏูโูุง ุฑุง ุฏุฑ ูุงูุจ ุจููฺฉโูุง ฑฒธ ุจุช (ฑถ ุจุงุช) ูพุฑุฏุงุฒุด ูโฺฉูุฏ. ูฺฉุชู ฺฉูุฏ ุฏุฑ ููู AESุ ูุญูู ููุงุด ู ุฏุณุชฺฉุงุฑ ุงู ุจููฺฉโูุง ุฏุงุฏู ุงุณุช. ูุฑ ุจููฺฉ ฑฒธ ุจุช ูุฑูุฏ (ูุชู ุงุตู) ู ููฺูู ฺฉูุฏูุง ุฏูุฑุ ุจู ุตูุฑุช ฺฉ ูุงุชุฑุณ ดxด ุงุฒ ุจุงุชโูุง ุณุงุฒูุงูุฏู ูโุดููุฏ ฺฉู ุจู ุขู <strong>ุขุฑุงู ุญุงูุช (State Array)</strong> ุง ุจู ุงุฎุชุตุงุฑ "ุญุงูุช" (State) ฺฏูุชู ูโุดูุฏ.
            </p>
            <div class="code-block" style="text-align:center; direction:ltr;">
State = [ s<sub>0,0</sub>  s<sub>0,1</sub>  s<sub>0,2</sub>  s<sub>0,3</sub> ]
        [ s<sub>1,0</sub>  s<sub>1,1</sub>  s<sub>1,2</sub>  s<sub>1,3</sub> ]
        [ s<sub>2,0</sub>  s<sub>2,1</sub>  s<sub>2,2</sub>  s<sub>2,3</sub> ]
        [ s<sub>3,0</sub>  s<sub>3,1</sub>  s<sub>3,2</sub>  s<sub>3,3</sub> ]</div>
            <p>ุนููุงุช ูุฎุชูู AES (ฺฉู ุฏุฑ ุงุฏุงูู ุชูุถุญ ุฏุงุฏู ูโุดููุฏ) ุชุจุฏูุงุช ุฑุงุถ ู ููุทู ุฑุง ุฑู ุงู ุขุฑุงู ุญุงูุช ุงุนูุงู ูโฺฉููุฏ.</p>
        </section>
        <hr/>
        <section id="aes-key-specs-detailed">
            <h2>ูุดุฎุตุงุช ุงุตู ู ุชุนุฏุงุฏ ุฏูุฑูุง</h2>
            <ul>
                <li><strong>ุงูุฏุงุฒู ุจููฺฉ:</strong> ูููุงุฑู ฑฒธ ุจุช (ฑถ ุจุงุช)ุ ูุนุงุฏู ฺฉ ูุงุชุฑุณ ุญุงูุช ดxด.</li>
                <li><strong>ุงูุฏุงุฒู ฺฉูุฏ:</strong> ฑฒธุ ฑนฒ ุง ฒตถ ุจุช.</li>
                <li><strong>ุชุนุฏุงุฏ ุฏูุฑูุง (Nr):</strong> ูุงุจุณุชู ุจู ุทูู ฺฉูุฏ (Nkุ ุชุนุฏุงุฏ ฺฉููุงุช ณฒ ุจุช ุฏุฑ ฺฉูุฏ):
                    <ul>
                        <li>ฺฉูุฏ ฑฒธ ุจุช (Nk=4): ฑฐ ุฏูุฑ</li>
                        <li>ฺฉูุฏ ฑนฒ ุจุช (Nk=6): ฑฒ ุฏูุฑ</li>
                        <li>ฺฉูุฏ ฒตถ ุจุช (Nk=8): ฑด ุฏูุฑ</li>
                    </ul>
                </li>
            </ul>
        </section>
        <hr/>
        <section id="aes-encryption-process-detailed">
            <h2>ูุฑุขูุฏ ฺฉู ุฑูุฒูฺฏุงุฑ ุฏุฑ AES</h2>
            <p>ุฑูุฒูฺฏุงุฑ ฺฉ ุจููฺฉ ุฏุงุฏู ุฏุฑ AES ุดุงูู ูุฑุงุญู ุฒุฑ ุงุณุช:</p>
            <ol>
                <li><strong>ฺฏุณุชุฑุด ฺฉูุฏ (Key Expansion):</strong> ุงุฒ ฺฉูุฏ ุฑูุฒ ุงุตู (Cipher Key)ุ ูุฌููุนูโุง ุงุฒ ฺฉูุฏูุง ุฏูุฑ (Round Keys) ุชููุฏ ูโุดูุฏ. ูุฑ ฺฉูุฏ ุฏูุฑ ูุฒ ฺฉ ูุงุชุฑุณ ดxด ุงุฒ ุจุงุชโูุง ุงุณุช. ุงู ูุฑุขูุฏ ุฎูุฏ ุดุงูู ุนููุงุช ุจุงุชุ ุฌุงฺฏุดุช ฺฉููุงุช (<code>RotWord</code>)ุ ุงุณุชูุงุฏู ุงุฒ S-Box (ุฏุฑ <code>SubWord</code>) ู XOR ุจุง ุจุฑุฏุงุฑูุง ุซุงุจุช ุฏูุฑ (<code>Rcon</code>) ุงุณุช.</li>
                <li><strong>ุฏูุฑ ุงููู (Initial Round):</strong>
                    <ul>
                        <li><code>AddRoundKey</code>: ุขุฑุงู ุญุงูุช ุงููู ุจุง ุงููู ฺฉูุฏ ุฏูุฑ XOR ูโุดูุฏ. ุงู ูุนุงุฏู ุฌูุน ุจุฑุฏุงุฑ ุฏุฑ ูุถุง ุจุฑุฏุงุฑ ุฑู $GF(2)$ ุงุณุช ฺฉู ุนูุงุตุฑ ุขู ุจุชโูุง ูุณุชูุฏุ ุง ุฌูุน ูุงุชุฑุณ ุนูุตุฑ ุจู ุนูุตุฑ ุจุง ุนูู XOR.</li>
                    </ul>
                </li>
                <li><strong>ุฏูุฑูุง ุงุตู (Main Rounds - Nr-1 ุฏูุฑ):</strong> ูุฑ ุฏูุฑ ุดุงูู ฺูุงุฑ ุชุจุฏู ุงุณุช:
                    <ul>
                        <li><code>SubBytes</code> (ุฌุงฺฏุฒู ุจุงุชโูุง โ ฺฉ ุชุจุฏู ุบุฑุฎุท)</li>
                        <li><code>ShiftRows</code> (ุดูุช ุณุทุฑ โ ฺฉ ุฌุงฺฏุดุช ุฎุท)</li>
                        <li><code>MixColumns</code> (ุชุฑฺฉุจ ุณุชูู โ ฺฉ ุชุจุฏู ุฎุท ุฑู ุณุชููโูุง)</li>
                        <li><code>AddRoundKey</code> (ุฌูุน ูุงุชุฑุณ ุจุง ฺฉูุฏ ุฏูุฑ ุจุนุฏ)</li>
                    </ul>
                </li>
                <li><strong>ุฏูุฑ ููุง (Final Round - ุฏูุฑ Nrุงู):</strong> ุดุงูู ุณู ุชุจุฏู:
                    <ul>
                        <li><code>SubBytes</code></li>
                        <li><code>ShiftRows</code></li>
                        <li><code>AddRoundKey</code></li>
                    </ul>
                    (ูุฑุญูู <code>MixColumns</code> ุฏุฑ ุงู ุฏูุฑ ุญุฐู ูโุดูุฏ).
                </li>
            </ol>
        </section>
        <hr/>
        <section class="math-section">
            <h3>ูฺฏุงู ุฑุงุถ ุนููโุชุฑ ุจู ูุฑุงุญู AES ุจุง ุงุณุชูุงุฏู ุงุฒ ุฌุจุฑ ุฎุท</h3>
            <p>ุฏุฑ ุงู ุจุฎุดุ ุจุฑุฎ ุงุฒ ูุฑุงุญู ฺฉูุฏ AES ุฑุง ุจุง ุชูุฑฺฉุฒ ุจุฑ ุงุตูู ุฌุจุฑ ุฎุท ู ุฑุงุถุงุช ูุฏุงูโูุง ูุชูุงู ุจุฑุฑุณ ูโฺฉูู.</p>

            <h4>ฑ. ุนููุงุช ุฏุฑ ูุฏุงู ฺฏุงููุง $GF(2^8)$</h4>
            <p>ุจุณุงุฑ ุงุฒ ูุญุงุณุจุงุช AES ุฏุฑ ูุฏุงู ูุชูุงู $GF(2^8)$ (ุฎูุงูุฏู ูโุดูุฏ "ุฌ ุงูู ุฏู ุจู ุชูุงู ูุดุช") ุงูุฌุงู ูโุดููุฏ. ุนูุงุตุฑ ุงู ูุฏุงูุ ุจุงุชโูุง (ุงุนุฏุงุฏ ธ ุจุช) ูุณุชูุฏ ฺฉู ูโุชูุงู ุขูโูุง ุฑุง ุจู ุนููุงู ฺูุฏุฌูููโุงโูุง ุงุฒ ุฏุฑุฌู ุญุฏุงฺฉุซุฑ ท ุจุง ุถุฑุงุจ ฐ ุง ฑ ุฏุฑ ูุธุฑ ฺฏุฑูุช. ุจุฑุง ูุซุงูุ ุจุงุช <code>10110011</code> (ุง <code>0xB3</code>) ูุนุงุฏู ฺูุฏุฌูููโุง $x^7 + x^5 + x^4 + x + 1$ ุงุณุช.</p>
            <ul>
                <li><strong>ุฌูุน (+) ุฏุฑ $GF(2^8)$:</strong> ูุนุงุฏู ุนูู XOR (โ) ุจุช ุงุณุช. ุงู ููุงู ุฌูุน ฺูุฏุฌูููโุงโูุง ุฏุฑ $GF(2)[x]$ ุงุณุช.</li>
                <li><strong>ุถุฑุจ (ยท) ุฏุฑ $GF(2^8)$:</strong> ุถุฑุจ ฺูุฏุฌูููโุงโูุง ุงุณุช ฺฉู ูุชุฌู ุขู ุจุฑ ฺฉ ฺูุฏุฌูููโุง ฺฉุงูุดโูุงูพุฐุฑ (irreducible polynomial) ุฏุฑุฌู ธ ุชูุณู ุดุฏู ู ุจุงููุงูุฏู ุจู ุนููุงู ุญุงุตู ุถุฑุจ ุฏุฑ ูุธุฑ ฺฏุฑูุชู ูโุดูุฏ. ฺูุฏุฌูููโุง ฺฉุงูุดโูุงูพุฐุฑ ุงุณุชุงูุฏุงุฑุฏ ุฏุฑ AESุ $m(x) = x^8 + x^4 + x^3 + x + 1$ (ุง <code>0x11B</code>) ุงุณุช.</li>
            </ul>

            <h4 id="subbytes-math">ฒ. ุชุจุฏู SubBytes (ุฌุงฺฏุฒู ุจุงุชโูุง)</h4>
            <p>ุงู ฺฉ ุชุจุฏู <strong>ุบุฑุฎุท</strong> ุงุณุช ฺฉู ูุฑ ุจุงุช ุงุฒ ุขุฑุงู ุญุงูุช ุฑุง ุจู ุทูุฑ ูุณุชูู ุจุง ุจุงุช ุฏฺฏุฑ ุงุฒ ุทุฑู ุฌุฏูู S-Box ุฌุงฺฏุฒู ูโฺฉูุฏ. ุณุงุฎุชุงุฑ S-Box ุงุฒ ุฏู ูุฑุญูู ุฑุงุถ ุชุดฺฉู ุดุฏู ุงุณุช:</p>
            <ol>
                <li><strong>ูุญุงุณุจู ูุงุฑูู ุถุฑุจ ุฏุฑ $GF(2^8)$:</strong> ูุฑ ุจุงุช ูุฑูุฏ $b$ (ุจู ุฌุฒ ุจุงุช <code>0x00</code> ฺฉู ุจู ุฎูุฏุด ูฺฏุงุดุช ูโุดูุฏ) ุจุง ูุงุฑูู ุถุฑุจโุงุด $b^{-1}$ ุฏุฑ ูุฏุงู $GF(2^8)$ ุฌุงฺฏุฒู ูโุดูุฏ. ุนู $b \cdot b^{-1} \equiv 1 \pmod{m(x)}$.</li>
                <li><strong>ุงุนูุงู ฺฉ ุชุจุฏู ุขูู (Affine Transformation) ุจุฑ ุฑู ุจุชโูุง $b^{-1}$:</strong> ุจุงุช $b^{-1}$ (ฺฉู ูุชุฌู ูุฑุญูู ูุจู ุงุณุช) ุจู ุนููุงู ฺฉ ุจุฑุฏุงุฑ ธ ุจุช $v = [v_7, v_6, \dots, v_0]^T$ ุฏุฑ ูุธุฑ ฺฏุฑูุชู ูโุดูุฏ. ุณูพุณ ุจุฑุฏุงุฑ ุฌุฏุฏ $v'$ ุงุฒ ุทุฑู $v' = \mathbf{A} \cdot v \oplus \mathbf{c}$ ูุญุงุณุจู ูโุดูุฏ. ุฏุฑ ุงูุฌุงุ $\mathbf{A}$ ฺฉ ูุงุชุฑุณ ุซุงุจุช ธxธ ุจุง ุฏุฑุงูโูุง ฐ ู ฑ ุงุณุช ู $\mathbf{c}$ ฺฉ ุจุฑุฏุงุฑ ุซุงุจุช ธ ุจุช (<code>0x63</code> ุง <code>01100011</code>) ุงุณุช. ุชูุงู ูุญุงุณุจุงุช ุฏุฑ ุงู ุชุจุฏู ุขูู (ุถุฑุจ ูุงุชุฑุณ ู ุฌูุน ุจุฑุฏุงุฑ) ุฏุฑ $GF(2)$ ุงูุฌุงู ูโุดูุฏ (ุนู ุฌูุน ููุงู XOR ุงุณุช).
                <div class="code-block" style="font-size: 0.8em; text-align:center;">
[v'<sub>0</sub>]   [1 0 0 0 1 1 1 1] [v<sub>0</sub>]   [1]
[v'<sub>1</sub>]   [1 1 0 0 0 1 1 1] [v<sub>1</sub>]   [1]
[v'<sub>2</sub>]   [1 1 1 0 0 0 1 1] [v<sub>2</sub>]   [0]
[v'<sub>3</sub>] = [1 1 1 1 0 0 0 1] [v<sub>3</sub>] โ [0]
[v'<sub>4</sub>]   [1 1 1 1 1 0 0 0] [v<sub>4</sub>]   [0]
[v'<sub>5</sub>]   [0 1 1 1 1 1 0 0] [v<sub>5</sub>]   [1]
[v'<sub>6</sub>]   [0 0 1 1 1 1 1 0] [v<sub>6</sub>]   [1]
[v'<sub>7</sub>]   [0 0 0 1 1 1 1 1] [v<sub>7</sub>]   [0]
                </div>
                </li>
            </ol>
            <p>ุงู ุณุงุฎุชุงุฑ ุฏู ูุฑุญููโุงุ S-Box ุฑุง ุฏุฑ ุจุฑุงุจุฑ ุญููุงุช ฺฉุฑูพุชูุชุญูู ุฎุท ู ุฏูุฑุงูุณู ููุงูู ูโฺฉูุฏ.</p>

            <h4 id="shiftrows-math">ณ. ุชุจุฏู ShiftRows (ุดูุช ุณุทุฑ)</h4>
            <p>ุงู ฺฉ ุชุจุฏู <strong>ุฎุท</strong> ู ุฏุฑ ูุงูุน ฺฉ ุนููุงุช ุฌุงฺฏุดุช (permutation) ุงุณุช. ุจุงุชโูุง ูุฑ ุณุทุฑ ุงุฒ ุขุฑุงู ุญุงูุช ุจู ุตูุฑุช ฺุฑุฎุด ุจู ุณูุช ฺูพ ุดูุช ุฏุงุฏู ูโุดููุฏ. ุงฺฏุฑ ุขุฑุงู ุญุงูุช ุฑุง $S$ ุจูุงููุ ู $S_{i,j}$ ุนูุตุฑ ุณุทุฑ $i$ ู ุณุชูู $j$ ุจุงุดุฏุ ุขูฺฏุงู ุญุงูุช ุฌุฏุฏ $S'$ ุจู ุงู ุตูุฑุช ุงุณุช: $S'_{i,j} = S_{i, (j+c_i) \pmod 4}$ ฺฉู $c_i$ ูุฒุงู ุดูุช ุจุฑุง ุณุทุฑ $i$ ุงุณุช ($c_0=0, c_1=1, c_2=2, c_3=3$).</p>

            <h4 id="mixcolumns-math">ด. ุชุจุฏู MixColumns (ุชุฑฺฉุจ ุณุชูู)</h4>
            <p>ุงู ุชุจุฏู ูุฒ ฺฉ ุนููุงุช <strong>ุฎุท</strong> ููู ุจุฑุง ุฎุงุตุช ูพุฑุงฺฉูุฏฺฏ (diffusion) ุฏุฑ AES ุงุณุช. ูุฑ ุณุชูู ุงุฒ ุขุฑุงู ุญุงูุช ุจู ุทูุฑ ูุณุชูู ูพุฑุฏุงุฒุด ูโุดูุฏ. ูุฑ ุณุชูู $s = [s_0, s_1, s_2, s_3]^T$ (ฺฉู ฺฉ ุจุฑุฏุงุฑ ด ุนูุตุฑ ุงุณุช ู ูุฑ ุนูุตุฑ ฺฉ ุจุงุช ุฏุฑ $GF(2^8)$ ุงุณุช) ุฏุฑ ฺฉ ูุงุชุฑุณ ุซุงุจุช ดxด ุถุฑุจ ูโุดูุฏ ุชุง ุณุชูู ุฌุฏุฏ $s' = [s'_0, s'_1, s'_2, s'_3]^T$ ุจู ุฏุณุช ุขุฏ:</p>
            <div class="code-block" style="text-align:center; direction:ltr;">
[s'<sub>0</sub>]   [02  03  01  01]   [s<sub>0</sub>]
[s'<sub>1</sub>] = [01  02  03  01] * [s<sub>1</sub>]
[s'<sub>2</sub>]   [01  01  02  03]   [s<sub>2</sub>]
[s'<sub>3</sub>]   [03  01  01  02]   [s<sub>3</sub>]</div>
            <p>ุชูุงู ุนููุงุช ุถุฑุจ ู ุฌูุน ุฏุฑ ุงู ุถุฑุจ ูุงุชุฑุณุ ุฏุฑ ูุฏุงู $GF(2^8)$ ุงูุฌุงู ูโุดููุฏ. ุจู ุนููุงู ูุซุงู:</p>
            <p><code>s'<sub>0</sub> = (0x02 ยท s<sub>0</sub>) โ (0x03 ยท s<sub>1</sub>) โ (0x01 ยท s<sub>2</sub>) โ (0x01 ยท s<sub>3</sub>)</code></p>
            <p>ุงุฏุขูุฑ ูโุดูุฏ ฺฉู:</p>
            <ul>
                <li>ุถุฑุจ ุฏุฑ <code>0x01</code> ุฎูุฏ ุจุงุช ุงุณุช.</li>
                <li>ุถุฑุจ ุฏุฑ <code>0x02</code> (ุชุงุจุน <code>xtime</code>): ุงฺฏุฑ ุจุช ูพุฑุงุฑุฒุด ุจุงุช $b$ ุตูุฑ ุจุงุดุฏุ ูุชุฌู $2b$ ุงุณุช (ุดูุช ุจู ฺูพ). ุงฺฏุฑ ุจุช ูพุฑุงุฑุฒุด ฺฉ ุจุงุดุฏุ ูุชุฌู $2b \oplus \text{0x1B}$ ุงุณุช.</li>
                <li>ุถุฑุจ ุฏุฑ <code>0x03</code> ุจุฑุงุจุฑ ุงุณุช ุจุง $(0x02 \cdot b) \oplus b$.</li>
            </ul>
            <p>ุงู ุชุจุฏู ุฎุท ุชุถูู ูโฺฉูุฏ ฺฉู ูพุณ ุงุฒ ฺูุฏ ุฏูุฑุ ุชูุงู ุจุงุชโูุง ุฎุฑูุฌ ุจู ุชูุงู ุจุงุชโูุง ูุฑูุฏ ูุงุจุณุชู ุจุงุดูุฏ.</p>

            <h4 id="addroundkey-math">ต. ุชุจุฏู AddRoundKey (ุงูุฒูุฏู ฺฉูุฏ ุฏูุฑ)</h4>
            <p>ุงู ุชุจุฏู ฺฉ ุนููุงุช <strong>ุฎุท</strong> ุณุงุฏู ุงุณุช. ุขุฑุงู ุญุงูุช ฑฒธ ุจุช ุจุง ฺฉูุฏ ุฏูุฑ ฑฒธ ุจุช XOR ูโุดูุฏ. ุงฺฏุฑ ุญุงูุช $S$ ู ฺฉูุฏ ุฏูุฑ $K_{round}$ ุฑุง ุจู ุนููุงู ูุงุชุฑุณโูุง ดxด ุฏุฑ ูุธุฑ ุจฺฏุฑูุ ุขูฺฏุงู ุญุงูุช ุฌุฏุฏ $S'$ ุงุฒ $S'_{i,j} = S_{i,j} \oplus K_{round,i,j}$ ุจุฑุง ุชูุงู $i,j$ ุจู ุฏุณุช ูโุขุฏ. ุงู ูุนุงุฏู ุฌูุน ุจุฑุฏุงุฑ (ุนูุตุฑ ุจู ุนูุตุฑ) ุฏู ูุงุชุฑุณ ุฏุฑ ูุถุง ุจุฑุฏุงุฑ ุฑู $GF(2)$ ุงุณุช.</p>
        </section>
        <hr/>
        
        <section id="simple-aes-calculator-section">
            <h2>ูุงุดู ุญุณุงุจ ุณุงุฏู AES (ุฑูุฒฺฏุฐุงุฑ ู ุฑูุฒฺฏุดุง) ๐งฎ</h2>
            <p>ุจุง ุงู ุงุจุฒุงุฑ ูโุชูุงูุฏ ุจู ุณุงุฏฺฏ ูุชู ุฎูุฏ ุฑุง ุจุง AES ุฑูุฒฺฏุฐุงุฑ ู ุฑูุฒฺฏุดุง ฺฉูุฏ.</p>
            
            <div id="simple-aes-calculator">
                <h3>ุงุจุฒุงุฑ ุฑูุฒูฺฏุงุฑ ู ุฑูุฒฺฏุดุง AES</h3>

                <div class="aes-calc-group">
                    <button onclick="generateAesKey()">๐ ุชููุฏ ฺฉูุฏ ฑฒธ ุจุช AES</button>
                    <div class="key-display-area" style="margin-top:10px;">
                        <strong>ฺฉูุฏ ูุนู (Base64):</strong> <span id="aes_key_display">- ูููุฒ ฺฉูุฏ ุชููุฏ ูุดุฏู -</span>
                    </div>
                </div>
                <hr/>
                <div class="aes-calc-group">
                    <label for="aes_plaintext_input">ูุชู ุงุตู ุจุฑุง ุฑูุฒฺฏุฐุงุฑ:</label>
                    <textarea id="aes_plaintext_input" placeholder="ูุชู ฺฉู ูโุฎูุงูุฏ ุฑูุฒ ุดูุฏ ุฑุง ุงูุฌุง ูุงุฑุฏ ฺฉูุฏ..."></textarea>
                    <button onclick="encryptAesText()">๐ ุฑูุฒฺฏุฐุงุฑ ูุชู</button>
                </div>
                <hr/>
                <div class="aes-calc-group">
                    <label for="aes_ciphertext_input">ูุชู ุฑูุฒ ุดุฏู (Base64 ุจุง ูุฑูุช IV.Ciphertext):</label>
                    <textarea id="aes_ciphertext_input" placeholder="ูุชู ุฑูุฒ ุดุฏู (ููุฑุงู ุจุง IV ุฏุฑ ุงุจุชุฏุง ุขู ู ุฌุฏุง ุดุฏู ุจุง ููุทู) ุฑุง ุจุฑุง ุฑูุฒฺฏุดุง ุงูุฌุง ูุงุฑุฏ ฺฉูุฏ..."></textarea>
                    <button onclick="decryptAesText()">๐ ุฑูุฒฺฏุดุง ูุชู</button>
                </div>
                <hr/>
                <div class="aes-calc-group">
                    <label for="aes_decrypted_output">ูุชู ุฑูุฒฺฏุดุง ุดุฏู:</label>
                    <textarea id="aes_decrypted_output" readonly placeholder="ูุชุฌู ุฑูุฒฺฏุดุง ุงูุฌุง ููุงุด ุฏุงุฏู ูโุดูุฏ..."></textarea>
                </div>

                <div class="calc-log-aes-simple">
                    <h4>Log:</h4>
                    <pre id="aes_simple_calc_log_content"></pre>
                </div>
            </div>
        </section>
        <p class="note" style="text-align:center; margin-top:30px;">ุงู ุตูุญู ุฏุฑ 1 ุชุฑ ูุงู 1404 ุงุฒ ุฏุณุชุฑุณ ุฎุงุฑุฌ ูุดูุฏ.</p>
    </div>

<script>
let currentAesKey = null; // Stores the CryptoKey object
let aesSimpleLogHistory = [];

function addSimpleAesLog(message) {
    const timestamp = new Date().toLocaleTimeString('en-US');
    aesSimpleLogHistory.push(`[${timestamp}] ${message}`);
    if (aesSimpleLogHistory.length > 30) { // Increased log size slightly
        aesSimpleLogHistory.shift();
    }
    const logContentElement = document.getElementById('aes_simple_calc_log_content');
    if (logContentElement) {
        logContentElement.textContent = aesSimpleLogHistory.join('\n');
        logContentElement.scrollTop = logContentElement.scrollHeight;
    }
}

// Helper to convert ArrayBuffer to Base64
function arrayBufferToBase64(buffer) {
    let binary = '';
    const bytes = new Uint8Array(buffer);
    const len = bytes.byteLength;
    for (let i = 0; i < len; i++) {
        binary += String.fromCharCode(bytes[i]);
    }
    return window.btoa(binary);
}

// Helper to convert Base64 to ArrayBuffer
function base64ToArrayBuffer(base64) {
    try {
        const binary_string = window.atob(base64);
        const len = binary_string.length;
        const bytes = new Uint8Array(len);
        for (let i = 0; i < len; i++) {
            bytes[i] = binary_string.charCodeAt(i);
        }
        return bytes.buffer;
    } catch (e) {
        addSimpleAesLog(`Error: Invalid Base64 string: ${e.message}`);
        console.error("Base64 to ArrayBuffer error:", e);
        return null;
    }
}

async function generateAesKey() {
    try {
        currentAesKey = await window.crypto.subtle.generateKey(
            {
                name: "AES-CBC", 
                length: 128, 
            },
            true, 
            ["encrypt", "decrypt"]
        );
        addSimpleAesLog("AES 128-bit key (CBC mode) generated successfully.");
        
        const exportedKeyBuffer = await window.crypto.subtle.exportKey("raw", currentAesKey);
        document.getElementById('aes_key_display').textContent = arrayBufferToBase64(exportedKeyBuffer);

    } catch (error) {
        addSimpleAesLog(`Error generating AES key: ${error.message}`);
        console.error("AES Key Generation Error:", error);
        document.getElementById('aes_key_display').textContent = "ุฎุทุง ุฏุฑ ุชููุฏ ฺฉูุฏ";
    }
}

async function encryptAesText() {
    const plaintext = document.getElementById('aes_plaintext_input').value;
    const ciphertextArea = document.getElementById('aes_ciphertext_input');
    ciphertextArea.value = ''; 

    if (!currentAesKey) {
        addSimpleAesLog("Encryption Error: No AES key. Please generate a key first.");
        alert("ูุทูุงู ุงุจุชุฏุง ฺฉ ฺฉูุฏ AES ุชููุฏ ฺฉูุฏ.");
        return;
    }
    if (!plaintext) {
        addSimpleAesLog("Encryption Info: Plaintext is empty.");
        alert("ูุทูุงู ูุชู ุจุฑุง ุฑูุฒฺฏุฐุงุฑ ูุงุฑุฏ ฺฉูุฏ.");
        return;
    }

    try {
        const encoder = new TextEncoder();
        const data = encoder.encode(plaintext);
        
        // IV for AES-CBC is 16 bytes (128 bits)
        const iv = window.crypto.getRandomValues(new Uint8Array(16)); 

        const encryptedDataBuffer = await window.crypto.subtle.encrypt(
            {
                name: "AES-CBC",
                iv: iv,
            },
            currentAesKey,
            data
        );
        
        const ivBase64 = arrayBufferToBase64(iv.buffer);
        const ciphertextBase64 = arrayBufferToBase64(encryptedDataBuffer);
        
        // Combine IV and Ciphertext for easier handling by user, separated by a dot.
        const combinedOutput = ivBase64 + "." + ciphertextBase64;
        ciphertextArea.value = combinedOutput;

        addSimpleAesLog("Text encrypted successfully.");
        addSimpleAesLog(`  IV (Base64): ${ivBase64.substring(0,10)}...`);
        addSimpleAesLog(`  Ciphertext (Base64): ${ciphertextBase64.substring(0,20)}...`);

    } catch (error) {
        addSimpleAesLog(`Encryption Error: ${error.message}`);
        console.error("AES Encryption Error:", error);
        ciphertextArea.value = "ุฎุทุง ุฏุฑ ุฑูุฒฺฏุฐุงุฑ";
    }
}

async function decryptAesText() {
    const combinedInput = document.getElementById('aes_ciphertext_input').value;
    const decryptedTextArea = document.getElementById('aes_decrypted_output');
    decryptedTextArea.value = ''; 

    if (!currentAesKey) {
        addSimpleAesLog("Decryption Error: No AES key available.");
        alert("ฺฉูุฏ AES ุจุฑุง ุฑูุฒฺฏุดุง ููุฌูุฏ ูุณุช. ูุทูุงู ุงุจุชุฏุง ฺฉ ฺฉูุฏ ุชููุฏ ฺฉูุฏ ุง ุงุฒ ูุฌูุฏ ุขู ูุทูุฆู ุดูุฏ.");
        return;
    }
    if (!combinedInput) {
        addSimpleAesLog("Decryption Info: Ciphertext input is empty.");
        alert("ูุทูุงู ูุชู ุฑูุฒ ุดุฏูโุง ุจุฑุง ุฑูุฒฺฏุดุง ูุงุฑุฏ ฺฉูุฏ.");
        return;
    }

    try {
        const parts = combinedInput.split('.');
        if (parts.length !== 2) {
            addSimpleAesLog("Decryption Error: Invalid input format. Expected IV_base64.Ciphertext_base64");
            throw new Error("ูุฑูุช ูุฑูุฏ ูุงูุนุชุจุฑ ุงุณุช. ุจุงุฏ ุจู ุตูุฑุช IV.Ciphertext (ูุฑ ุฏู Base64) ุจุงุดุฏ.");
        }
        const ivBase64 = parts[0];
        const ciphertextBase64 = parts[1];

        const ivBuffer = base64ToArrayBuffer(ivBase64);
        const ciphertextBuffer = base64ToArrayBuffer(ciphertextBase64);

        if (!ivBuffer || !ciphertextBuffer) {
            throw new Error("ุฎุทุง ุฏุฑ ุชุจุฏู Base64 ูุฑูุฏ IV ุง ูุชู ุฑูุฒ ุดุฏู.");
        }
         if (ivBuffer.byteLength !== 16) { // AES block size / IV size for CBC
            addSimpleAesLog(`Decryption Error: Invalid IV length (${ivBuffer.byteLength} bytes). Expected 16 bytes.`);
            throw new Error(`ุทูู IV ูุงูุนุชุจุฑ ุงุณุช. ุจุงุฏ ฑถ ุจุงุช ุจุงุดุฏุ ุงูุง ${ivBuffer.byteLength} ุจุงุช ุฏุฑุงูุช ุดุฏ.`);
        }

        const decryptedDataBuffer = await window.crypto.subtle.decrypt(
            {
                name: "AES-CBC",
                iv: new Uint8Array(ivBuffer), 
            },
            currentAesKey,
            ciphertextBuffer
        );

        const decoder = new TextDecoder();
        decryptedTextArea.value = decoder.decode(decryptedDataBuffer);
        addSimpleAesLog("Text decrypted successfully.");

    } catch (error) {
        addSimpleAesLog(`Decryption Error: ${error.message}. Ensure key, IV, and ciphertext are correct.`);
        console.error("AES Decryption Error:", error);
        decryptedTextArea.value = `ุฎุทุง ุฏุฑ ุฑูุฒฺฏุดุง: ${error.message}`;
    }
}

window.addEventListener('load', function() {
    if (document.getElementById('aes_simple_calc_log_content')) {
        addSimpleAesLog("Simple AES Encrypt/Decrypt tool initialized.");
        addSimpleAesLog("Generate a key, then enter text to encrypt or Base64 (IV.Ciphertext) to decrypt.");
    }
});
</script>

</body>
</html>
